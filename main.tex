\documentclass[letter]{article}
%%\documentclass[a4paper]{article}
%\usepackage{sectsty}
%\sectionfont{\fontsize{8}{2}\selectfont}
\font\myfont=cmr12 at 12pt
\title{{\myfont Flavor wave model homework problems}}
\usepackage{natbib}
\usepackage{graphicx}
\usepackage{titlesec}
\usepackage{bm}
\usepackage{amssymb}
\usepackage{braket}
\usepackage{mathtools}
\usepackage{amsmath}
\usepackage{mathrsfs}
\usepackage{ulem}
\setcounter{MaxMatrixCols}{20}
\usepackage{siunitx}
\usepackage{mathabx}
\usepackage{ulem}
\usepackage{textgreek}
%\usepackage[T1]{fontenc}
%\usepackage[type1]{libertine}
%\usepackage{newtxmath}
\let\oldemptyset\emptyset
\let\emptyset\varnothing
\titlelabel{\thetitle.\quad}
\usepackage{geometry}
\geometry{left=1cm,right=0.5cm,top=0.5cm,bottom=2cm}
\newcommand{\stkout}[1]{\ifmmode\text{\sout{\ensuremath{#1}}}\else\sout{#1}\fi}
\newcommand{\e}{\mathrm{e}}
\newcommand{\ii}{\mathrm{i}}
\newcommand{\dd}{\mathrm{d}}
\usepackage{upgreek}
%\makeatletter
%\re@DeclareMathSymbol{\aalpha}{\mathord}{lettersA}{11}
%\makeatother
\begin{document}
\maketitle
The purpose of this file is to understand and develop your own program of the flavor wave model.\\
{\large{A}}. In this part, we will develop a method to solve the ground state without diagonalizing the Hamiltonian. \\
\indent (1)  Assume a particle can be discribed by spin only, with $S=1$. and the Hamiltonian is 
$$ H= S_z.
$$
Write down the matrix form for $H$, the eigenstates of $H$ and their energies. We will write down the ground state to be $\left|a_0\right>$.\\
\indent Comment: In this note, we use the commutation relation for spin operators: $[S_x,S_y]=\ii S_z$ in stead of $[S_x,S_y]=\ii \hbar S_z$. Which means for spin $1/2$, $S_z=\begin{bmatrix}
    1/2 & 0 \\
    0 &  -1/2
    \end{bmatrix}$ instead of $ S_z=\begin{bmatrix}
        \hbar/2 & 0 \\
        0 &  -\hbar/2
        \end{bmatrix}$. \\
\indent (2) Assume a initial state to be $\left|\psi_0\right>=\frac{1}{\sqrt{3}}(\left|S_z=-1\right>+\left|S_z=0\right>+\left|S_z=1\right>)$. Let $\varepsilon=10^{-2}$. Calculate 
$$\left|\phi_1\right>=\left(1-\varepsilon H \right)\left|\psi_0\right>$$
$$\left|\psi_1\right>=\frac{\left|\phi_1\right>}{\left<\phi_1|\phi_1\right>}$$
Look at the $\left|\psi_1\right>$, and show that  there are more weights of ground state in $\left|\psi_1\right>$ than $\left|\psi_0\right>$.\\
\indent (3) Define 
$$\left|\phi_{n+1}\right>=\left(1-\varepsilon H\right) \left|\psi_n\right>$$
$$\left|\psi_{n+1}\right>=\frac{\left|\phi_{n+1}\right>}{\left<\phi_{n+1}|\phi_{n+1}\right>}.$$
Draw (i)$\left|\left<a_0|\psi_n\right>\right|^2$ as a function of $n$. and 
(ii) $\left<\psi_n|H|\psi_n\right>$ as a function of n. Also try with differenct positive values of $\varepsilon$ and see how the value will change the speed of converging.\\
\indent (4) repeat (2) and (3) with $\left|\psi_0\right>=\left|S_z=0\right>$. (Some weird thing could happen, depending on the computer.)\\ 
\indent (5) repeat (4) but in each step, add a random small distortion to the wavefunction. Observe how the algorithm converges. Remember to Normalize the wavefunction after distortion. \\ 
\indent (6) For a general Hamiltonian
$$ H = \sum_{i=0}^{d-1} E_{i} \left|a_i\right>\left<a_i\right|
$$
with the eigenenergies $E_0<E_1\leq E_2 \leq \ldots\leq E_{d-1}$, prove that $\forall \left|\psi_0\right> $ that $\left<a_0|\psi_0\right>\neq 0$, $\exists \varepsilon>0$, the series $\{\left| \psi_n\right>\}$ generatred in (2) satisfies $$
\lim_{n\rightarrow\infty} \left|\left<a_0|\psi_n\right>\right|^2=1.
$$
\indent Hint: Consider an $\varepsilon$ that $0<\varepsilon<1/|E_{d-1}|$ and find a $q$ that $0<q<1$ and $\left(1-\sqrt{\left|\left<a_0|\psi_{n+1}\right>\right|^2}\right)<q\left(1-\sqrt{\left|\left<a_0|\psi_{n}\right>\right|^2}\right)$.\\
\indent Comment: From this part, to make sure the algorithm works, a small fluctuaction should be added in each step to get a nonzero $\left<a_0|\psi_0\right>$.\\
\indent (7) Now we know that this algorithrm always converges. Let's figure out how to make it fast. Consider a Hamiltonian in (6) with conditions $d>2$ and $E_0<E_1<E_{d-1}$. Define:$$\left|\phi_{n+1}\right>=\left(-H+z\right) \left|\psi_n\right>$$
$$\left|\psi_{n+1}\right>=\frac{\left|\phi_{n+1}\right>}{\left<\phi_{n+1}|\phi_{n+1}\right>}.$$
where $z$ is a real number and define $x_n=1-\left|\left<a_0|\psi_n\right>\right|$
. Prove that, when $x_0<1$, (i) $\forall z >\frac{-E_0-E_{d-1}}{2}$, $\exists q$, $0< q <1$ and $$
\lim _{n\rightarrow \infty} \frac{x_{n+1}}{x_n}=q,
$$
and (ii) $q$ is minimized when $$z=-\frac{1}{2}\left(E_1+E_{d-1}\right)$$\\
{\large{B}}. This part is to use the method in A to solve the ground state with mean-field approximation. \\
\indent Consider 2 identical interacting atoms in an external magnetic field and they both have spin-orbital coupling. The Hamiltonian is 
$$
H=H_1+H_2+H_{12}
$$
where $H_1$ and $H_2$ are the Hamiltonian of two isolated atoms and $H_{12}$ describes the interaction between the atoms. This will be calculated with mean field approximation later. \\
\indent (1) First we will write down $H_{1}$ and $H_2$. Assume these two atoms are same and both have quantum numbers $S=1/2$ and $L=1$. The Hamiltonian is a sum of spin-orbital coupling and also coupling to the external magnetic field $\bm{B}$.
$$H_1=\lambda \bm{S}\cdot\bm{L}+\mu_{\mathrm{B}}(2\bm{S}+\bm{L})\cdot\bm{B}
$$
To write down the matrix form, we need work in the proper space. The space is a product of spin space and orbital space, which means the dimension should be the product of dimension of the spin space and the dimension of the orbital space $(2S+1)(2L+1)=6$. Because when any spin operator is projected into the orbital space, it should be identity, we can write down the operators in this way:
$$S_z=\begin{bmatrix}
1/2 & 0\\
0 & -1/2
\end{bmatrix} \otimes \begin{bmatrix}
1 &0 &0\\
0 & 1 & 0 \\
0 &0 &1
\end{bmatrix}=\begin{bmatrix}
1/2 &0 &0 &0 &0 &0\\
0 &1/2 &0 &0 &0 &0\\
0 &0 &1/2 &0 &0 &0\\
0 &0 &0 &-1/2 &0 &0\\
0 &0 &0 &0 &-1/2 &0\\
0 &0 &0 &0 &0 &-1/2
\end{bmatrix}
$$
$$L_z=\begin{bmatrix}
1 & 0\\
0 & 1
\end{bmatrix} \otimes \begin{bmatrix}
1 &0 &0\\
0 & 0 & 0 \\
0 &0 &-1
\end{bmatrix}=\begin{bmatrix}
1 &0 &0 &0 &0 &0\\
0 &0 &0 &0 &0 &0\\
0 &0 &-1 &0 &0 &0\\
0 &0 &0 &1 &0 &0\\
0 &0 &0 &0 &0 &0\\
0 &0 &0 &0 &0 &-1
\end{bmatrix}
$$
now you can write down the single atom Hamiltonian
$$
H_1=\lambda \bm{S}\cdot\bm{L}+\mu_{\mathrm{B}}(2\bm{S}+\bm{L})\cdot\bm{B}=\lambda(S_xL_x+S_yL_y+S_zL_z)+\mu_{\mathrm{B}}(B_x(2S_x+L_x)+B_y(2S_y+L_y)+B_z(2S_z+L_z))
$$
and look at how the eigenvalues change as a function of $\lambda$ and $\bm{B}$.\\
\indent (2) Assume the interaction between two atoms is $$
H_{12}=J \bm{S}_1 \cdot \bm{S}_2
$$
To solve the ground state, we should work in a larger space of dimension $6\times 6=36$, but this matrix is assumed to be too large and we will apply mean-field approximation.
In mean field approximation, we will ignore the entanglement between the atoms, which means the ground state can be written as a product of two atoms$$
\left|\psi_{1,2}\right>=\left|\psi_1\right>\otimes\left|\psi_2\right>
$$ and total Hamiltonian on atom 1 is 
$$h_1=H_1+J\bm{S}\cdot\left<\psi_2|\bm{S}|\psi_2\right>=J(S_x\left<\psi_2|S_x|\psi_2\right>+S_y\left<\psi_2|S_y|\psi_2\right>+S_z\left<\psi_2|S_z|\psi_2\right>)
$$
and also the total Hamiltonian on atom 2 is
$$h_2=H_2+J\bm{S}\cdot\left<\psi_1|\bm{S}|\psi_1\right>=J(S_x\left<\psi_1|S_x|\psi_1\right>+S_y\left<\psi_1|S_y|\psi_1\right>+S_z\left<\psi_1|S_z|\psi_1\right>)
$$
Notice that $h_1$ is a function of $\left|\psi_2\right>$. Now you can use the method in part A on two atoms to solve the groud state. You can plot the magnetic moment as a function of $\lambda$, $J$ and $\bm{B}$.\\
%%\indent (3) Now let apply this aprroximation to a magnetic system. Consider a 2D triangular lattice with the atoms in part (1). Assume we have $n$ atoms, then the dimenshion of the space will be $((2S+1)(2L+1))^n$. Even for a small number n, this number explodes very fast. To be able to solve this, we will ignore the entanglement between the atoms. This means the total wavefunction $\left|\Psi\right>$ will be product of individual wave functions $\left|\psi_{\bm{r}}\right>$, where $\bm{r}$ is the position of the atom $\bm{r}=a_1 \bm{a}+a_2 \bm{b}$ and $\bm{a}$, $\bm{b}$ are the lattice vectors with $\bm{a}\cdot \bm{b}=0$:
%%$$\left|\Psi\right>=\prod_{\bm{r}} \left|\psi_{\bm{r}}\right>.
%%$$
%%he last approximation we are going to apply is that all the $ \left|\psi_{\bm{r}}\right>$ equal to each other so we assign$$
%%\left|\psi_{\bm{r}}\right>=\left|\psi\right>, \forall {\bm{r}}
%%$$ One must be carefull with this approximation. This only works at a ferromagnetic phase. In other phases, there will be more atoms in per magnetic unit cell. We will show how to do this later. \\
%%Now lets assume the interactions between neighours have two types. Along $\bm{a}$ direction, there exist a coupling $-J_a \bm{S_{\bm{r}}}\cdot \bm{S}_{\bm{r}+\bm{a}}$ and long $\bm{b}$ direction, there is $-J_b \bm{S_{\bm{r}}}\cdot \bm{S}_{\bm{r}+\bm{b}}$. To keep this system ferromagnetic, we will assume that $J_a$ and $J_b$ are all positive. Since now we already assumed the wavefunctions for all atoms, we will use the method in part A to solve the wave function. The actual Hamiltonian we use consists three parts, the spin orbital coupling, coupling to external magnetic field, and the mean field from neighbours. The sum will be $$
%%h=\lambda \bm{S}\cdot\bm{L}+\mu_{\mathrm{B}}(2\bm{S}+\bm{L})\cdot\bm{B}-2J_a\bm{S}\cdot\left<\psi\right|\bm{S}\left|\psi\right>-2J_b\bm{S}\cdot\left<\psi\right|\bm{S}\left|\psi\right>
%%$$ 
%%There is a coefficiten 2 because each atom has 2 neighbours in both directions. Notice that this effective Hamiltonian is a function of the wavefunction, so normal diagnolization method doesn't work hear. Use the algarithm in part (A) to solve the ground state of this system. Observe how the ground state changes with $\lambda$, $J_a$, $J_b$, and  $\bm{B}$.\\
\indent (4) Let consider the same atom with $L=1$ and $S=1/2$ in a chain with ferromagnetic coupling between nearest neighbours. This gives a terrifying Hamiltonian: 
$$
H=\sum _ {i} \lambda \bm{S}_i \cdot \bm{L}_i+ \mu_{\mathrm{B}} (2\bm{S}_i+\bm{L}_i)\cdot \bm{B}-J \bm{S}_i\cdot \bm{S}_{i+1}
$$
where $\bm{S}_i$ is the spin operator of the $i$-th atom on the chain. $\lambda$ is an arbitraty real number and $J$ is positive.
First we write down the effective Hamiltionina on each atom with a wave function $\left|\psi\right>$

$$
\begin{aligned}
    h &=\lambda \bm{S} \cdot \bm{L}+\mu_{\mathrm{B}} (2\bm{S}+\bm{L})\cdot \bm{B}-2J \bm{S}\cdot \left<\psi\right|\bm{S}\left|\psi \right>\\
    &=\lambda \left(S_xL_x+S_y L_y+S_z L_z\right)+\mu_{\mathrm{B}}\left( B_x(2S_x+L_x)+B_y(2S_y+L_y)+B_z(2S_z+L_z) \right)\\&\ \ \ \ \ \ \ \ \ -2JS_x\left<\psi\right|S_x\left|\psi\right>-2JS_y\left<\psi\right|S_y\left|\psi\right>-2JS_z\left<\psi\right|S_z\left|\psi\right>
\end{aligned}
$$
where all the matrices are $(2S+1)(2L+1)=6$ dimensional matrices. Now lets assign numbers $\lambda=\SI{1}{\milli\electronvolt}$  and $J=\SI{1}{\milli\electronvolt}$ wich constant $\mu_{\mathrm{B}}=\SI{0.05788}{\milli\electronvolt/\tesla}$, you should be able to get the ground state. Try start from a external field  $\bm{B}=\SI{40}{\tesla}\ \hat{z}$ and decrease the field to 0 slowly. Calculate the magnetic dipole per atom $m_z=-\left<\psi\right|2S_z+L_z\left|\psi\right>$ and plot the magnetic dipole as a function of field. You should see the saturated first at a strong field, which gives $m_z=2$. As field decreases, you should see $m_z$ starts decreasing at a certain field and it doen't go to 0 when the field aprroches 0 and it jumps when the field changes sign. This makes sense because this is a ferromagnetic system and there is only single domain. \\
\indent(5) Now we will look at a antiferromagnetic system. The difference is that there are 2 atoms per unit cell. We will label the atoms as $(i,1)$ and $(i,2)$. With a positive number $J$, the Hamiltonian is $$
H=\sum_i\lambda\left(\bm{S}_{i,1}\cdot\bm{L}_{i,1}+\bm{S}_{i,2}\cdot\bm{L}_{i,2}\right)+\mu_{\mathrm{B}} (2\bm{S}_{i,1}+\bm{L}_{i,1}+2\bm{S}_{i,2}+\bm{L}_{i,2})\cdot \bm{B}+\frac{J}{2  }\left(\bm{S}_{i-1,2}\cdot\bm{S}_{i,1}+2\bm{S}_{i,1}\cdot\bm{S}_{i,2}+\bm{S}_{i,2}\cdot\bm{S}_{i+1,1}\right)
$$ We will apply the assumption: $\left|\psi_{i,1}\right>=\left|\psi_1 \right>$ and $\left|\psi_{i,2}\right>=\left|\psi_2 \right>$ and now the mean field on atom 1 will be:
$$\begin{aligned}
    h_1 &=\lambda \bm{S} \cdot \bm{L}+\mu_{\mathrm{B}} (2\bm{S}+\bm{L})\cdot \bm{B}+2J \bm{S}\cdot \left<\psi_2\right|\bm{S}\left|\psi_2 \right>\\
    &=\lambda \left(S_xL_x+S_y L_y+S_z L_z\right)+\mu_{\mathrm{B}}\left( B_x(2S_x+L_x)+B_y(2S_y+L_y)+B_z(2S_z+L_z) \right)\\&\ \ \ \ \ \ \ \ \ +2JS_x\left<\psi_2\right|S_x\left|\psi_2\right>+2JS_y\left<\psi_2\right|S_y\left|\psi_2\right>+2JS_z\left<\psi_2\right|S_z\left|\psi_2\right>
\end{aligned}
$$
and switch 1 and 2 to get the mean field for atom 2:
$$\begin{aligned}   
   h_2 &=\lambda \left(S_xL_x+S_y L_y+S_z L_z\right)+\mu_{\mathrm{B}}\left( B_x(2S_x+L_x)+B_y(2S_y+L_y)+B_z(2S_z+L_z) \right)\\&\ \ \ \ \ \ \ \ \ +2JS_x\left<\psi_1\right|S_x\left|\psi_1\right>+2JS_y\left<\psi_1\right|S_y\left|\psi_1\right>+2JS_z\left<\psi_1\right|S_z\left|\psi_1\right>
\end{aligned}
$$
Now start a strong magnetic field and calculate the magnetic dipole as a function of field. Notice that the algotighm fails at a weak field.\\
{\large{C}}. This part is about flavour model. We will solve the dispersion of magnons and other extra modes. Lets start from theory calculations and then apply the algorithm on ferromagnetic chain, antiferromagnetic chain, 2D ferromagnetic chain, and some actual materials. There are three practice examples and we will be using them for the whole C part.  \\
--------------------------------\\
\indent (a). 1D ferromagnetic chain with Heisenberg interaction between nearest neighbours, all the atoms only have spin degree of freedom. The Hamiltonian is $$
H=\sum_{i}g\mu_{\mathrm{B}}\bm{B}\cdot\bm{S}_i-J\bm{S}_{i}\cdot\bm{S}_{i+1}
$$
$g$ is the Lande  g-factor. $J$ is positive. The Hamiltonian can be rewitten as $$
H=\sum_{i}g\mu_{\mathrm{B}}(B^x S^x +B^y S^y+B^z S^z)-J(S_{i}^x S_{i+1}^x+S_{i}^y S_{i+1}^y+S_{i}^z S_{i+1}^z)
$$\\
\indent (b). 1D antiferromagnetic chain with Heisenberg interaction between nearest neighbouts, all the atoms only have spin degree of freedom. The Hamiltonian is $$
\begin{aligned}
    H&=\sum_i g\mu _{\mathrm{B}}\bm{B}\cdot(\bm{S}_{i,1}+\bm{S}_{i,2})+J(\bm{S}_{i,1}\cdot\bm{S}_{i,2}+\bm{S}_{i,1}\cdot\bm{S}_{i-1,2} )\\
   & =\sum_i g\mu _{\mathrm{B}}\bm{B}\cdot(\bm{S}_{i,1}+\bm{S}_{i,2})+J(S_{i,1}^x S_{i,2}^x+S_{i,1}^y S_{i,2}^y+S_{i,1}^z S_{i,2}^z+S_{i,1}^x S_{i-1,2}^x+S_{i,1}^y S_{i-1,2}^y+S_{i,1}^z S_{i-1,2}^z)
\end{aligned}
$$\\
\indent (c). 2D triangular ferromagnetic system with a ring-exchange and a easy plane. Since it is a 2D system, we need two integers to label unit cells. $S$ needs to be larger than 1/2. Let's assume $S=1$, The Hamiltonian is $$
H=\sum_{i,j}g\mu _{\mathrm{B}} \bm{B}\cdot \bm{S}_{i,j}-\delta (S_i^z)^2-J_1\bm{S}_{i,j}\cdot\bm{S}_{i+1,j}-J_2\bm{S}_{i,j}\cdot\bm{S}_{i,j+1}-rS_{i,j}^+S_{i+1,j}^+S_{i,j+1}^+S_{i+1,j+1}^+-r^*S_{i,j}^-S_{i+1,j}^-S_{i,j+1}^-S_{i+1,j+1}^-
$$
where $r$ is an arbitrary complex number. This is the number that controls the ring exchange.\\
--------------------------------\\
\\
\indent (1). In this part we will show the argorithm for an arbitrary systen. We assume the system has some unit cells which can be labeled as the position of each cell $\{\bm{r}\}$, each unit cell has $N$ same atoms, which all have $d$ dimensions. The total hamiltonian should be written as $$
H=\sum_{\bm{r}}\sum_{p=1}^{N}H_{\bm{r},p}+H_{\mathrm{interaction}}
$$ and constained by symmetry, all the $H_{\bm{r},p}$ ahouls be same for all $\bm{r}$. The interaction part will be a sum of a list, each list of the term will have this form: $\sum_{\bm{r}}J_{(\bm{0},p_1),(\bm{r}_2,p_2)\cdots (\bm{r}_s,p_s)} \bm{X}^1_{\bm{r},p_1} \bm{X}^2_{\bm{r}+\bm{r}_2,p_2} \cdots\bm{X}^s_{\bm{r}+\bm{r}_s,p_s}$. For the three examples, we have 3, 6, and 8 terms. \\
 After these examples, we will assume the ground state is already solved and the $i$-th atom in all unit cells have the same wave function:$$
\left|\psi_{\bm{r},p}\right>=\left|\psi_p\right>
$$
and the local mean field hamiltoain is known and diagonalized:
$$
h_p=\sum_{m=0}^{d-1}E_{p,m}\left|\psi_{p,m}\right>\left<\psi_{p,m}\right|
$$
where $E_{p,0}<E_{p,1}\leqslant \cdots\leqslant E_{p,d-1}$, and $\left|\psi_{p,0}\right>=\left|\psi_p\right>$
Now, for any operator $\hat{X}$ acting on the $i$-th atom, we will introduce a expansion, define number: $$
X_{p,mn}=\left<\psi_{p,m}\right|\hat{X}\left|\psi_{p,n}\right>
$$
and the $\hat{X}$ operator acting on $p$-th  atom of the $\bm{r}$ unit cell will have a expansion:
$$
\hat{X}\approx X_{p,00}+\sum_{m=1}^{d-1}\left(\hat{b}_{\bm{r}pm}^{\dagger}X_{p,m0}+X_{p,0m}\hat{b}_{\bm{r}pm}\right)-X_{p,00}\sum_{m=1}^{d-1}\hat{b}^{\dagger}_{\bm{r}pm}\hat{b}_{\bm{r}im}
+\sum_{m=1}^{d-1}\sum_{n=1}^{d-1}\hat{b}^{\dagger}_{\bm{r}pm}X_{p,mn}\hat{b}_{\bm{r}pn}$$
where the $b$ and $b^{\dagger}$ operators follow the commutation relations:
$$
\left[\hat{b}_{\bm{r}pm},\hat{b}_{\bm{r}'qn}\right]=\left[\hat{b}^{\dagger}_{\bm{r}pm},\hat{b}^{\dagger}_{\bm{r}'qn}\right]=0$$
$$
\left[\hat{b}_{\bm{r}pm},\hat{b}^{\dagger}_{\bm{r}'qn}\right]=\delta_{\bm{r}\bm{r}'}\delta_{pq}\delta_{mn}$$
Now for each term in the interaction list, you can apply this expansion and get a bunch of terms. Only the second order terms will be kept. You should get a hamiltonian in this form:
 $$H=\sum_{\bm{r},\bm{r}'}\mathbf{X}^{\dagger}_{\bm{r}}\mathbf{H}_{\bm{r}\bm{r}'}\mathbf{X}_{\mathrm{r}'}$$
 where $\mathbf{X}_{\bm{r}}$ is a column verctors of dimension $2N(d-1)$, $$\mathbf{X}_{\bm{r}}=\left(b_{\bm{r},11},b_{\bm{r},12},\cdots,b_{\bm{r},1(d-1)},b_{\bm{r},21},\cdots,b_{\bm{r},N(d-1)},b_{\bm{r},1i}^{\dagger},b_{\bm{r},12}^{\dagger},\cdots,b_{\bm{r},1(d-1)}^{\dagger},b_{\bm{r},21}^{\dagger},\cdots,b_{\bm{r},N(d-1)}^{\dagger}\right)^{\mathsf{T}}$$
and $\mathbf{H}_{\bm{r},\bm{r}'}$ is a $2N(d-1)\times 2N(d-1)$ matrix.\\
---------------------------------\\
 For example, in example (a), Let's put in numbers $S=1$, $g=2$ and $J=\SI{1}{\milli\electronvolt}$
and $\bm{B}=-\SI{0.01}{\tesla}\ \hat{x}.$ We can write down the mean field(in meV):
$$\begin{aligned}
    h&=  g\mu_{\mathrm{B}} B^z S^z-2J S^z \left<\psi\right|S_z\left|\psi\right>\\
    & = 2\times 0.05788\times 0.01\times  \begin{bmatrix}
        1 & 0 & 0\\
       0 &  0 & 0\\
        0& 0 & -1
        \end{bmatrix}-2\times1\times\left( \begin{bmatrix}
            0 & \frac{1}{\sqrt{2}} & 0\\
            \frac{1}{\sqrt{2}} &  0 &\frac{1}{\sqrt{2}}\\
        0& \frac{1}{\sqrt{2}}& 0
            \end{bmatrix} \left<\psi\right|S_x\left|\psi\right>\right.\\
           & {\ \ \ \ \ \ \ \ \ \ \ \ \ \ }\indent \indent\indent\indent\left.+\begin{bmatrix}
                0& -\frac{\ii}{\sqrt{2}} & 0\\
                \frac{\ii}{\sqrt{2}} &  0 & -\frac{\ii}{\sqrt{2}}\\
            0& \frac{\ii}{\sqrt{2}}&0
                \end{bmatrix} \left<\psi\right|S_y\left|\psi\right>+\begin{bmatrix}
            1 & 0 & 0\\
        0 &  0 & 0\\
        0& 0&-1
            \end{bmatrix} \left<\psi\right|S_z\left|\psi\right>\right)
\end{aligned}$$
Using the method in part (B), we can find the ground state $\left|\psi\right>$ and the mean field $h$:
$$
\left|\psi\right>=\begin{bmatrix}
    1.00 \\
0.00 \\
0.00
    \end{bmatrix}
$$
$$
h=\begin{bmatrix}
    -2.00116 & 0 & 0 \\
    0 &  0 & 0 \\
    0 &  0 & 2.00116
    \end{bmatrix}
$$
now we can diagnolize the Hamiltonian:
$$E_{0}=-2.00116,\ E_{1}=0.00000,\ E_{2}=2.00116
$$
$$\left|\psi_0\right>=\begin{bmatrix}
    1 \\
0 \\
0
    \end{bmatrix},\left|\psi_1\right>=\begin{bmatrix}
       0 \\
    1 \\
    0
        \end{bmatrix},\left|\psi_2\right>=\begin{bmatrix}
            0 \\
            0 \\
            1
            \end{bmatrix}
$$
with these numbers, we can get the transformed matrices for $S^x$, $S^y$, $S^z$( because this is a easy problem, I will be using the exact answers. In real materails, onle numerical values are available):
$$S^x_{mn}=\begin{bmatrix}
    0& \frac{1}{\sqrt{2}} & 0\\
    \frac{1}{\sqrt{2}} &  0 & \frac{1}{\sqrt{2}}\\
0& \frac{1}{\sqrt{2}}&0
    \end{bmatrix}$$$$
S^y_{mn}=\begin{bmatrix}
    0& -\frac{\ii}{\sqrt{2}} & 0\\
    \frac{\ii}{\sqrt{2}} &  0 & -\frac{\ii}{\sqrt{2}}\\
0& \frac{\ii}{\sqrt{2}}&0
    \end{bmatrix}$$ $$
S^z_{mn}=\begin{bmatrix}
1 & 0 & 0 \\
0 &  0 & 0 \\
0 &  0 & -1
\end{bmatrix}
$$
Now the operators can be written in a series( since there is only one atom per unit cell, we will remove the $p$ index, only write as $b_{im}$):$$
S_{i}^{x}\approx\frac{1}{\sqrt{2}}\ b_{i1}^{\dagger}+\frac{1}{\sqrt{2}}\ b_{i1}+\frac{1}{\sqrt{2}}\  b_{i1}^{\dagger}b_{i2}+\frac{1}{\sqrt{2}}\  b_{i2}^{\dagger}b_{i1}$$$$
S_{i}^{y}\approx\frac{\ii}{\sqrt{2}}\ b_{i1}^{\dagger}-\frac{\ii}{\sqrt{2}}\ b_{i1}-\frac{\ii}{\sqrt{2}}\ b_{i1}^{\dagger}b_{i2}+\frac{\ii}{\sqrt{2}}\ b_{i2}^{\dagger}b_{i1}$$$$
S_{i}^{z}\approx1-b_{i1}b_{i1}^{\dagger}-2b_{i2}b_{i2}^{\dagger}$$
\indent Comment: Notice even in this form, all spin operators keep Hermitian.\\
\indent Now For the three interactions $S_{i}^x S_{i+1}^x$, $S_{i}^y S_{i+1}^y$, $S_{i}^z S_{i+1}^z$, we will show (only the quadratic terms)
$$
\begin{aligned}
    S_{i}^x S_{i+1}^x &\approx\frac{1}{2}\left(b_{i1}^{\dagger}b_{(i+1)1}^{\dagger}+b_{i1}b_{(i+1)1}+b_{i1}b_{(i+1)1}^{\dagger}+b_{i1}^{\dagger}b_{(i+1)1}\right)\\ &=\left[
        b_{i1}^{\dagger} \ \ 
        b_{i2}^{\dagger}\  \ 
        b_{i1}\ \ 
        b_{i2}\right]
       \begin{bmatrix}
            \frac{1}{2} & 0 & \frac{1}{2} & 0 \\
           0 &  0 & 0 &0 \\
           \frac{1}{2} &  0 & \frac{1}{2} &0\\
            0 & 0 & 0& 0
            \end{bmatrix}\begin{bmatrix}
                b_{(i+1)1}  \\
                b_{(i+1)2}  \\
                b_{(i+1)1}^{\dagger}\\
                b_{(i+1)2}^{\dagger}
                \end{bmatrix}
\end{aligned}
$$
$$
\begin{aligned}
    S_{i}^y S_{i+1}^y &\approx0.500000\frac{1}{2}\left(-b_{i1}^{\dagger}b_{(i+1)1}^{\dagger}-b_{i1}b_{(i+1)1}+b_{i1}b_{(i+1)1}^{\dagger}+b_{i1}^{\dagger}b_{(i+1)1}\right)\\ &=\left[
        b_{i1}^{\dagger} \ \ 
        b_{i2}^{\dagger}\  \ 
        b_{i1}\ \ 
        b_{i2}\right]
        \begin{bmatrix}
            \frac{1}{2} & 0 & -\frac{1}{2} & 0 \\
           0 &  0 & 0 &0 \\
           -\frac{1}{2} &  0 & \frac{1}{2} &0\\
            0 & 0 & 0& 0
            \end{bmatrix}\begin{bmatrix}
                b_{(i+1)1}  \\
                b_{(i+1)2}  \\
                b_{(i+1)1}^{\dagger}\\
                b_{(i+1)2}^{\dagger}
                \end{bmatrix}
\end{aligned}
$$
$$
\begin{aligned}
    S_{i}^z S_{i+1}^z &\approx-\left(b_{i1}^{\dagger}b_{i1}+b_{(i+1)1}^{\dagger}b_{(i+1)1}\right)-2\left(b_{i2}^{\dagger}b_{i2}+b_{(i+1)2}^{\dagger}b_{(i+1)2}\right)
\end{aligned}
$$
There are constants, because $b_{(i+1)1}b_{(i+1)1}^{\dagger}=b_{(i+1)1}^{\dagger}b_{(i+1)1}+1$, but it is not written. \\
--------------------------------\\
After the Hamiltonian is written, we will do Fourier transforms. Define:
$$ \begin{aligned}
    \hat{b}_{\bm{k}pm}=\frac{1}{\sqrt{A}}\sum_{\bm{r}}\hat{b}_{\bm{r}pm}\e^{-\ii\bm{k}\cdot\bm{r}} \\
    \hat{b}_{\bm{k}pm}^{\dagger}=\frac{1}{\sqrt{A}}\sum_{\bm{r}}\hat{b}_{\bm{r}pm}^{\dagger}\e^{\ii\bm{k}\cdot\bm{r}}
    \end{aligned} $$
where $A$ is the nomalizing factor which gives the commutation relation $\left[\hat{b}_{\bm{k}pm},\hat{b}_{\bm{k'}qn}^{\dagger}\right]=\delta_{\bm{k}\bm{k}'}\delta_{pq}\delta_{mn}$. Now the Hamiltonian can be written in the momentum space and a algorithm propose by Colpa could properly diagnolized this Hamiltonian. In the algorithm, the Hamiltonian is written as $\sum_{\bm{k}}\mathbf{X}^{\dagger}_{\bm{k}}\mathbf{H}_{\bm{k}}\mathbf{X}_{\bm{k}}$ where $\mathbf{X}_{\bm{k}}=\left(b_{\bm{k}11},\cdots,b_{\bm{k}1(d-1)},\cdots,b_{\bm{k}n(d-1))},b_{(-\bm{k})11}^{\dagger},\cdots,b_{(-\bm{k})n(d-1)}^{\dagger}\right)^{\mathsf{T}}$. It is very easy to get the energies. Difine a matrix:$$
\mathbf{g}=\begin{bmatrix}
    \mathbf{1} & \mathbf{0}  \\
    \mathbf{0} &  -\mathbf{1}
    \end{bmatrix},
$$
where $\mathbf{1}$ means an identity matrix of dimension $n(d-1)$ and $\mathbf{0}$ means a zero matrix. To get the energies, solve the eigenvalues of matrix $\mathbf{H}.\mathbf{g}$. There will be $n(d-1)$ positive numbers and the othere negitive ones on the positive numbers times $-1$. The $n(d-1)$ numbers are the energies of excitations. After this, Plotting the numbers as with different $k$ will give you the dispersion. \\
There is another way to get the energies and get information of the transformation. The first step is to do Cholesky decomposition $\mathbf{H}=\mathbf{K}^{\dagger}\mathbf{K}$. This requires that $\mathbf{H}$ must be positive definite, otherwise is not decomposivable. If you do not get this, it means that you made a mistake. (needs to be finished) \\
--------------------------------\\
In example (a). We will first show the the Fourier transformation for $S_j^z S_{j+1}^z$(since i is used for imaginary number, we will change the index or unit cell to $j$):\\
$$S_{j}^z S_{j+1}^z \approx-\left(b_{j1}^{\dagger}b_{j1}+b_{(j+1)1}^{\dagger}b_{(j+1)1}\right)-2\left(b_{j2}^{\dagger}b_{j2}+b_{(j+1)2}^{\dagger}b_{(j+1)2}\right)$$
We have $$
b_{km}=\frac{1}{\sqrt{A}}\sum_{j}b_{jm}\e^{-\ii (k j)}
$$$$
b^{\dagger}_{km}=\frac{1}{\sqrt{A}}\sum_{j}b_{jm}^{\dagger}\e^{+\ii (k j)}
$$
and the inverse transforms:$$
b_{jm}=\frac{1}{\sqrt{A}}\sum_{k}b_{km}\e^{\ii (k j)}
$$$$
b^{\dagger}_{jm}=\frac{1}{\sqrt{A}}\sum_{k}b_{km}^{\dagger}\e^{-\ii (k j)}
$$
for $m=1,2$. and we have:
$$\begin{aligned}
&\indent \sum_j b_{j1}^{\dagger}b_{j1} \\
&=\frac{1}{A}\sum_{j}\sum_{k}\sum_{k'}b_{k1}^{\dagger}\e^{-\ii kj}b_{k'1}^{\dagger}\e^{+\ii k'j}\\
&=\frac{1}{A}\sum_{kk'}b_{k1}^{\dagger}b_{k'1}\sum_{j}\e^{\ii(k'-k)j}\\
&=\frac{1}{A}\sum_{kk'}b_{k1}^{\dagger}b_{k'1} A \delta_{k,k'}\\
&=\sum_{k}b_{k1}^{\dagger}b_{k1}
\end{aligned}
$$
Now the $S_j^z S_{j+1}^z$ term is going to be$$\begin{aligned}
& \indent \sum_j -\left(b_{j1}^{\dagger}b_{j1}+b_{(j+1))1}^{\dagger}b_{(j+1))1}\right)-2\left(b_{j2}^{\dagger}b_{j2}+b_{(j+1))2}^{\dagger}b_{(j+1))2}\right)\\
&= \sum_{k}-2b_{k1}^{\dagger}b_{k1}-4b_{k2}^{\dagger}b_{k2}\\
&=\sum_k \left[
    b_{k1}^{\dagger} \ \ 
    b_{k2}^{\dagger}\  \ 
    b_{(-k)1}\ \ 
    b_{(-k))2}\right]
   \begin{bmatrix}
        2 & 0 & 0 & 0 \\
       0 &  4 & 0 &0 \\
       0 &  0 & 0 &0\\
        0 & 0 & 0& 0
        \end{bmatrix}\begin{bmatrix}
            b_{k1}  \\
            b_{k2}  \\
            b_{(-k)1}^{\dagger}\\
            b_{(-k)2}^{\dagger}
            \end{bmatrix}
\end{aligned}
$$
and the $S_j^x S_{j+1}^x$ term:
$$\begin{aligned}
    & \indent  0.500000\sum_{j}\left(-b_{j1}^{\dagger}b_{(j+1)1}^{\dagger}-b_{j1}b_{(j+1)1}+b_{j1}b_{(j+1)1}^{\dagger}+b_{j1}^{\dagger}b_{(j+1)1}\right)\\
    &=\frac{0.500000}{A}\sum_{j}\sum_{k}\sum_{k'}\left(-b_{k1}^{\dagger}b_{k'1}^{\dagger}\e^{-\ii kj}\e^{-\ii k'(j+1)}-b_{k1}b_{k'1}\e^{\ii kj}\e^{\ii k'(j+1)}+b_{k1}b_{k'1}^{\dagger}\e^{\ii kj}\e^{-\ii k'(j+1)}+b_{k1}^{\dagger}b_{k'1}\e^{-\ii kj}\e^{\ii k'(j+1)}\right)\\
    &=\frac{0.500000}{A}\sum_{k}\sum_{k'}\left(-b_{k1}^{\dagger}b_{k'1}^{\dagger}\e^{-\ii k'}\sum_j \e^{-\ii (k+k')j}-b_{k1}b_{k'}\e^{\ii k'}\sum_j \e^{\ii (k+k')j}+b_{k1}b_{k'1}^{\dagger}\e^{-\ii k'}\sum_j \e^{\ii (k-k')j}+b_{k1}^{\dagger}b_{k'1}\e^{\ii k'}\sum_j \e^{-\ii (k+k')j}\right)\\
    &=0.500000\sum_k\sum_{k'}\left(-b_{k1}^{\dagger}b_{k'1}^{\dagger}\e^{-\ii k'}\delta_{-k,k'}-b_{k1}b_{k'1}\e^{\ii k'}\delta_{-k,k'}+b_{k1}b_{k'1}^{\dagger}\e^{-\ii k'}\delta_{k,k'}+b_{k1}^{\dagger}b_{k'1}\e^{\ii k'}\delta_{k,k'}\right)\\
    &=0.500000\sum_k\sum_{k'}\left(-b_{k1}^{\dagger}b_{(-k)1}^{\dagger}\e^{\ii k}-b_{k1}b_{(-k)1}\e^{-\ii k}+b_{k1}b_{k1}^{\dagger}\e^{-\ii k}+b_{k1}^{\dagger}b_{k1}\e^{\ii k}\right)\\
    &=0.500000\sum_k \left[
      b_{k1}^{\dagger} \ \ 
      b_{k2}^{\dagger}\  \ 
      b_{(-k)1}\ \ 
      b_{(-k))2}\right]
     \begin{bmatrix}
          -\e^{\ii k} & 0 & \e^{-\ii k} & 0 \\
         0 &  0 & 0 &0 \\
         \e^{\ii k} &  0 & -\e^{-\ii k} &0\\
          0 & 0 & 0& 0
          \end{bmatrix}\begin{bmatrix}
              b_{k1}  \\
              b_{k2}  \\
              b_{(-k)1}^{\dagger}\\
              b_{(-k)2}^{\dagger}
              \end{bmatrix}
  \end{aligned}
  $$
  and the $S_j^z S_{j+1}^z$ term:
  $$
\begin{aligned}
  & \indent  0.500000\sum_{j}\left(b_{j1}^{\dagger}b_{(j+1)1}^{\dagger}+b_{j1}b_{(j+1)1}+b_{j1}b_{(j+1)1}^{\dagger}+b_{j1}^{\dagger}b_{(j+1)1}\right)\\
  &=\frac{0.500000}{A}\sum_{j}\sum_{k}\sum_{k'}\left(b_{k1}^{\dagger}b_{k'1}^{\dagger}\e^{-\ii kj}\e^{-\ii k'(j+1)}+b_{k1}b_{k'1}\e^{\ii kj}\e^{\ii k'(j+1)}+b_{k1}b_{k'1}^{\dagger}\e^{\ii kj}\e^{-\ii k'(j+1)}+b_{k1}^{\dagger}b_{k'1}\e^{-\ii kj}\e^{\ii k'(j+1)}\right)\\
  &=\frac{0.500000}{A}\sum_{k}\sum_{k'}\left(b_{k1}^{\dagger}b_{k'1}^{\dagger}\e^{-\ii k'}\sum_j \e^{-\ii (k+k')j}+b_{k1}b_{k'}\e^{\ii k'}\sum_j \e^{\ii (k+k')j}+b_{k1}b_{k'1}^{\dagger}\e^{-\ii k'}\sum_j \e^{\ii (k-k')j}+b_{k1}^{\dagger}b_{k'1}\e^{\ii k'}\sum_j \e^{-\ii (k+k')j}\right)\\
  &=0.500000\sum_k\sum_{k'}\left(b_{k1}^{\dagger}b_{k'1}^{\dagger}\e^{-\ii k'}\delta_{-k,k'}+b_{k1}b_{k'1}\e^{\ii k'}\delta_{-k,k'}+b_{k1}b_{k'1}^{\dagger}\e^{-\ii k'}\delta_{k,k'}+b_{k1}^{\dagger}b_{k'1}\e^{\ii k'}\delta_{k,k'}\right)\\
  &=0.500000\sum_k\sum_{k'}\left(b_{k1}^{\dagger}b_{(-k)1}^{\dagger}\e^{\ii k}+b_{k1}b_{(-k)1}\e^{-\ii k}+b_{k1}b_{k1}^{\dagger}\e^{-\ii k}+b_{k1}^{\dagger}b_{k1}\e^{\ii k}\right)\\
  &=0.500000\sum_k \left[
    b_{k1}^{\dagger} \ \ 
    b_{k2}^{\dagger}\  \ 
    b_{(-k)1}\ \ 
    b_{(-k))2}\right]
   \begin{bmatrix}
        \e^{\ii k} & 0 & \e^{-\ii k} & 0 \\
       0 &  0 & 0 &0 \\
       \e^{\ii k} &  0 & \e^{-\ii k} &0\\
        0 & 0 & 0& 0
        \end{bmatrix}\begin{bmatrix}
            b_{k1}  \\
            b_{k2}  \\
            b_{(-k)1}^{\dagger}\\
            b_{(-k)2}^{\dagger}
            \end{bmatrix}
\end{aligned}
$$
Now we can write down the full Hamiltonian:
$$H=\sum_{k}$$
--------------------------------\\
\end{document}